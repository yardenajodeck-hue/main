<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CFD demo — Página para Vercel</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>CFD — Demo interactiva</h1>
      <p>Visualización simple de campo de flujo y partículas. Ajusta parámetros y observa el comportamiento.</p>
    </header>

    <main>
      <section class="controls">
        <label>Tipo de campo:
          <select id="fieldType">
            <option value="vortex">Vórtice</option>
            <option value="shear">Cizalla</option>
            <option value="source">Fuente/Sumidero</option>
          </select>
        </label>

        <label>Intensidad:
          <input id="strength" type="range" min="0" max="4" step="0.01" value="1" />
        </label>

        <button id="resetBtn">Reiniciar partículas</button>
      </section>

      <canvas id="flowCanvas"></canvas>

      <section class="info">
        <h2>Sobre esta demo</h2>
        <p>Esta página no es un solver CFD real; es una visualización educativa que muestra campos de velocidad 2D y advección de partículas para entender conceptos básicos de flujo.</p>
      </section>

      <section class="calculator">
        <h2>Calculadora CFD Interactiva</h2>
        <div class="calc-grid">
          <div class="calc-card">
            <h3>Número de Reynolds</h3>
            <label>Velocidad u (m/s): <input id="re-u" type="number" value="1" min="0.01" step="0.1" /></label>
            <label>Longitud L (m): <input id="re-L" type="number" value="1" min="0.01" step="0.1" /></label>
            <label>Viscosidad cinemática ν (m²/s): <input id="re-nu" type="number" value="1e-5" min="1e-7" step="1e-6" /></label>
            <button id="calcRe">Calcular Re</button>
            <div id="reResult" class="result"></div>
          </div>

          <div class="calc-card">
            <h3>Número de Péclet</h3>
            <label>Velocidad u (m/s): <input id="pe-u" type="number" value="1" min="0.01" step="0.1" /></label>
            <label>Δx (m): <input id="pe-dx" type="number" value="0.01" min="0.001" step="0.001" /></label>
            <label>Difusividad α (m²/s): <input id="pe-alpha" type="number" value="1e-5" min="1e-7" step="1e-6" /></label>
            <button id="calcPe">Calcular Pe</button>
            <div id="peResult" class="result"></div>
          </div>

        </div>
      </section>

      <section class="simulator">
        <h2>Simulador 1D: Advección-Difusión</h2>
        <div class="sim-controls">
          <label>Velocidad (u): <input id="sim-u" type="range" min="0" max="2" step="0.1" value="0.5" /></label>
          <label>Difusividad (α): <input id="sim-alpha" type="range" min="0" max="0.1" step="0.01" value="0.02" /></label>
          <label>Δt: <input id="sim-dt" type="range" min="0.001" max="0.1" step="0.001" value="0.01" /></label>
          <button id="simStart">Iniciar</button>
          <button id="simReset">Reiniciar</button>
          <span id="simTime" style="font-size:12px;color:var(--muted);">t = 0</span>
        </div>
        <canvas id="sim1dCanvas" style="width:100%;height:300px;margin-top:8px;border-radius:6px;"></canvas>
      </section>

      <section class="stencil">
        <h2>Visualizador de Stencils (Plantillas de Discretización)</h2>
        <div class="stencil-grid">
          <div class="stencil-card">
            <h4>Central 3-point (2º orden)</h4>
            <canvas id="stencil3" style="width:100%;height:120px;background:rgba(255,255,255,0.02);border-radius:4px;"></canvas>
            <small>$\phi' \approx (\phi_{i+1}-\phi_{i-1})/(2\Delta x)$</small>
          </div>
          <div class="stencil-card">
            <h4>Central 5-point (4º orden)</h4>
            <canvas id="stencil5" style="width:100%;height:120px;background:rgba(255,255,255,0.02);border-radius:4px;"></canvas>
            <small>orden superior, más puntos</small>
          </div>
          <div class="stencil-card">
            <h4>Upwind (1º orden)</h4>
            <canvas id="stencilUp" style="width:100%;height:120px;background:rgba(255,255,255,0.02);border-radius:4px;"></canvas>
            <small>$\phi' \approx (\phi_i-\phi_{i-1})/\Delta x$</small>
          </div>
          <div class="stencil-card">
            <h4>Convergencia (log-log)</h4>
            <canvas id="convCanvas" style="width:100%;height:120px;background:rgba(255,255,255,0.02);border-radius:4px;"></canvas>
            <button id="calcConv" style="width:100%;margin-top:4px;">Graficar convergencia</button>
          </div>
        </div>
      </section>

      <section class="units">
        <h2>Unidades 2–5: Resumen y respuestas</h2>

        <details open>
          <summary>Unit 2 — Ejecución de una simulación CFD (pasos y ejemplos)</summary>
          <ol>
            <li><strong>Definición del problema:</strong> objetivo, hipótesis, propiedades del fluido (ej.: flujo incompresible, laminar o turbulento).</li>
            <li><strong>Geometría y mallado:</strong> crear y refinar la malla; especificar zonas de refinamiento en bordes y gradientes.</li>
            <li><strong>Modelado físico:</strong> seleccionar NS, modelos de turbulencia, condiciones frontera y propiedades termofísicas.</li>
            <li><strong>Discretización:</strong> elegir esquema espacial/temporal (FV/FDM/FEM, upwind/central, explícito/implícito).</li>
            <li><strong>Solución:</strong> configurar solvers, precondicionadores, criterios de convergencia y acoplamientos (presión–velocidad).</li>
            <li><strong>Verificación y validación:</strong> pruebas de orden, comparación con soluciones analíticas o datos experimentales.</li>
            <li><strong>Postproceso:</strong> cálculo de fuerzas, tasas de transferencia, visualización de vorticidad y trazado de líneas de corriente.</li>
          </ol>
        </details>

        <details>
          <summary>Unit 3 — Discretización 1D (ecuaciones, derivadas y discretización de temperatura)</summary>
          <ul>
            <li><strong>Ecuaciones 1D:</strong>
              <ul>
                <li>Masa: $\partial_t \rho + \partial_x(\rho u)=0$</li>
                <li>Impulso: $\partial_t(\rho u)+\partial_x(\rho u^2)=-\partial_x p + \partial_x \tau_{xx}+\rho f_x$</li>
                <li>Temperatura (ej.): $\rho c_p(\partial_t T + u\partial_x T)=k\partial_{xx}T + Q$</li>
              </ul>
            </li>
            <li><strong>Continuo vs discreto:</strong> continuo = función $\phi(x)$; discreto = valores $\phi_i$ en nodos/celdas con truncation error.</li>
            <li><strong>Derivadas por Taylor:</strong> primera derivada central: $(\phi_{i+1}-\phi_{i-1})/(2\Delta x)$; segunda derivada: $(\phi_{i+1}-2\phi_i+\phi_{i-1})/\Delta x^2$.</li>
            <li><strong>Discretización ejemplo (advección–difusión explícita):</strong>
              $$\frac{T_i^{n+1}-T_i^n}{\Delta t}+u\frac{T_i^n-T_{i-1}^n}{\Delta x}=\alpha\frac{T_{i+1}^n-2T_i^n+T_{i-1}^n}{\Delta x^2}$$
            </li>
            <li><strong>Integración:</strong> tras discretizar en espacio se integra en tiempo con métodos ODE (expl./impl./RK).</li>
            <li><strong>Orden de exactitud:</strong> error de truncamiento ~ $O(\Delta x^p)$ → orden $p$.</li>
            <li><strong>Estimación de orden:</strong> refinamiento de malla (grid convergence), Richardson extrapolation.</li>
            <li><strong>Por qué separar errores:</strong> aclarar si la discrepancia es por modelo físico o por la numerics; optimizar coste.</li>
            <li><strong>Cuantidades conservadas:</strong> masa, momento, energía (o especies).</li>
            <li><strong>Dimensión mínima:</strong> 1D.</li>
          </ul>
        </details>

        <details>
          <summary>Unit 4 — Discretización en el tiempo (métodos y estabilidad)</summary>
          <ul>
            <li><strong>Explícito vs implícito:</strong> Euler forward $y^{n+1}=y^n+\Delta t f(t^n,y^n)$; Euler backward $y^{n+1}=y^n+\Delta t f(t^{n+1},y^{n+1})$.</li>
            <li><strong>Crank–Nicolson:</strong> promedio trapezoidal, segundo orden: $y^{n+1}=y^n+\tfrac{\Delta t}{2}[f^n+f^{n+1}]$.</li>
            <li><strong>Estabilidad y CFL/Péclet:</strong> condiciones de estabilidad limitan $\Delta t$ en métodos explícitos; Péclet $\mathrm{Pe}=u\Delta x/\nu$ y esquemas centrales pueden oscilar si $\mathrm{Pe}$ grande.</li>
            <li><strong>Pseudocódigo implícito (lineal):</strong> resolver $(I-\Delta t A)y^{n+1}=y^n$ por solver directo/iterativo.</li>
            <li><strong>Runge–Kutta:</strong> multiple stages; explícitos fáciles; implícitos estables pero costosos.</li>
          </ul>
        </details>

        <details>
          <summary>Unit 5 — Discretización en el espacio (stencils y notación)</summary>
          <ul>
            <li><strong>Discretizar transporte:</strong> transformar derivadas continuas en operadores discretos (FD/FV/FEM) sobre nodos/celdas.</li>
            <li><strong>Notación:</strong> celda central P, vecinos E (east), W (west), segmentos e/w.</li>
            <li><strong>Stencil:</strong> conjunto de puntos usados para aproximar derivadas; tamaño → orden y acoplamiento numérico.</li>
          </ul>
        </details>
      </section>
    </main>

    <footer>
      <small>Desplegable en Vercel: simplemente sube este proyecto o usa la CLI de Vercel.</small>
    </footer>

    <script src="script.js"></script>
  </body>
</html>